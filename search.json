[{"path":"https://mycology-microbiology-center.github.io/divermeta/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2024 divermeta authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/articles/divermeta.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Introduction to divermeta","text":"divermeta computes multiplicity, metric quantifies within‑cluster diversity typically neglected elements grouped units (e.g., genes homolog groups, ASVs OTUs, etc.). core funcion package divermeta(), computes multiple indices across samples . may request following indices via indices argument: inventory multiplicity: \"multiplicity_inventory\" distance‑based multiplicity (σ‑capped): \"multiplicity_distance\" optional companions: \"raoQ\", \"FD_sigma\", \"FD_q\", \"redundancy\" Additionally, package provides metagenomic.alpha.index() (MAD) standalone function computing Metagenomic Alpha-Diversity Index (see ). vignette uses tiny synthetic data keep runtime short outputs deterministic.","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/articles/divermeta.html","id":"installation","dir":"Articles","previous_headings":"","what":"Installation","title":"Introduction to divermeta","text":"can install development version divermeta GitHub : Load package:","code":"# install.packages(\"remotes\") remotes::install_github(\"Mycology-Microbiology-Center/divermeta\") library(divermeta)"},{"path":"https://mycology-microbiology-center.github.io/divermeta/articles/divermeta.html","id":"quick-start","dir":"Articles","previous_headings":"","what":"Quick start","title":"Introduction to divermeta","text":"create small features x samples abundance matrix, cluster membership vector aligned feature names, feature dissimilarity matrix 0-1 range. Columns correspond requested indices; rows correspond samples. Inventory multiplicity reflects average within‑cluster diversity; distance‑based multiplicity reflects average within‑cluster functional phylogenetic diversity distances capped threshold sigma (σ). can visualize input data structures side--side:  left plot shows abundance matrix (features x samples), tile size represents abundance magnitude. right plot shows distance matrix (pairwise distances features), tile size represents distance magnitude. Features f1-f2 belong cluster , f3-f4 belong cluster B. Notice within-cluster distances (f1-f2, f3-f4) smaller -cluster distances.","code":"# Features (rows) and samples (columns) features <- c(\"f1\", \"f2\", \"f3\", \"f4\") samples  <- c(\"S1\", \"S2\", \"S3\")  abund <- matrix(   c(     10,  4,  0,  # f1      0,  9,  6,  # f2      5,  3,  7,  # f3      6,  0, 12   # f4   ),   nrow = length(features), byrow = TRUE,   dimnames = list(features, samples) )  # Clusters per feature (named, aligned to rownames(abund)) clusters <- c(f1 = \"A\", f2 = \"A\", f3 = \"B\", f4 = \"B\")  # Optional dissimilarity among features (0-1); names must match abund rownames diss <- matrix(   c(     0.0, 0.2, 0.7, 1.0,     0.2, 0.0, 0.6, 0.9,     0.7, 0.6, 0.0, 0.4,     1.0, 0.9, 0.4, 0.0   ),   nrow = length(features), byrow = TRUE,   dimnames = list(features, features) )  # One call computes multiple indices across all samples res <- divermeta(   abund,   clusters = clusters,   diss     = diss,   q        = 1,   sig      = 0.8,   indices  = c(\"multiplicity_inventory\", \"multiplicity_distance\", \"raoQ\", \"redundancy\")) res #>   Sample multiplicity_inventory multiplicity_distance      raoQ redundancy #> 1     S1               1.434634              1.085995 0.4852608  0.1496599 #> 2     S2               1.651211              1.008499 0.2484375  0.3375000 #> 3     S3               1.648991              1.188623 0.3955200  0.2380800 visualize_abundance(abund, csize = 0.7, clegend = 0.4) visualize_dist(diss, csize = 0.7, clegend = 0.4)"},{"path":"https://mycology-microbiology-center.github.io/divermeta/articles/divermeta.html","id":"about-multiplicity-index","dir":"Articles","previous_headings":"","what":"About multiplicity index","title":"Introduction to divermeta","text":"multiplicity index diversity index design specially metagenomic data, can applied types ecological data. context clustering subunits (like strains, variants proteins) corresponding units (species, gene homolog group), multiplicity measures average intra cluster diversity across units diversity sacrificed chosen clustering scheme. clustering working directly obtained units, underlying composition diversity unit masked clustering scheme. index serves tool distinguish resulting units single representative subunit inside instead, composed several distinct subunits cluster together unit. following image gives graphical representation scenario  two versions index, distance agnostic version (inventory multiplicity) one incorporated notion similarity / distance subunits ’s calculation (distance-based multiplicity). case low hight distance-based multiplicity graphically represented following figure using distance matrices among subunits (unclustered) units (clustered)  details, please refer accompanying publication. illustrate multiplicity index concept using two samples cluster structure: High: multiple subunits per cluster (higher within‑cluster diversity) Low: one representative per cluster (lower within‑cluster diversity) expected, High shows larger multiplicity value Low, since cluster contains distinct subunits. Visualizing abundance matrices side--side helps illustrate difference:  High scenario (left), clusters (: f1+f2, B: f3+f4) contain multiple distinct features non-zero abundances, resulting higher multiplicity. Low scenario (right), cluster effectively contains one feature (f2 f4 zero abundance), resulting lower multiplicity. tile size represents abundance magnitude.","code":"knitr::include_graphics(\"../img/Multiplicity Chart V2.png\") knitr::include_graphics(\"../img/Multiplicity Matrix Chart V2.png\") # Reuse `features` and `clusters` from above abund_concept <- matrix(   c(     10, 10,  # f1 (A, representative)     10,  0,  # f2 (A, additional subunit present only in High)     12, 12,  # f3 (B, representative)      8,  0   # f4 (B, additional subunit present only in High)   ),   nrow = length(features), byrow = TRUE,   dimnames = list(features, c(\"High\",\"Low\")) )  concept_res <- divermeta(   abund_concept,   clusters = clusters,   indices  = \"multiplicity_inventory\",   q        = 1)  concept_res #>   Sample multiplicity_inventory #> 1   High               1.979966 #> 2    Low               1.000000 visualize_abundance(abund_concept[, \"High\", drop = FALSE],                      sample.labels = \"High multiplicity\",                     csize = 0.8, clegend = 0.5) visualize_abundance(abund_concept[, \"Low\", drop = FALSE],                      sample.labels = \"Low multiplicity\",                     csize = 0.8, clegend = 0.5)"},{"path":"https://mycology-microbiology-center.github.io/divermeta/articles/divermeta.html","id":"inventory-multiplicity","dir":"Articles","previous_headings":"About multiplicity index","what":"Inventory multiplicity","title":"Introduction to divermeta","text":"q controls abundance weighting (0 richness‑like, 1 Shannon‑type, 2 Simpson‑type). Higher q ‑weights rare subunits.","code":"res_q0 <- divermeta(   abund,   clusters = clusters,   indices  = \"multiplicity_inventory\",   q        = 0)  res_q1 <- divermeta(   abund,   clusters = clusters,   indices  = \"multiplicity_inventory\",   q        = 1)  res_q2 <- divermeta(   abund,   clusters = clusters,   indices  = \"multiplicity_inventory\",   q        = 2)  cbind(   Sample = res_q1$Sample,   M_q0   = res_q0$multiplicity_inventory,   M_q1   = res_q1$multiplicity_inventory,   M_q2   = res_q2$multiplicity_inventory) #>      Sample M_q0  M_q1               M_q2               #> [1,] \"S1\"   \"1.5\" \"1.43463376571196\" \"1.37267080745342\" #> [2,] \"S2\"   \"1.5\" \"1.65121096664765\" \"1.67924528301887\" #> [3,] \"S3\"   \"1.5\" \"1.64899100795382\" \"1.73362445414847\""},{"path":"https://mycology-microbiology-center.github.io/divermeta/articles/divermeta.html","id":"distancebased-multiplicity","dir":"Articles","previous_headings":"About multiplicity index","what":"Distance‑based multiplicity","title":"Introduction to divermeta","text":"Distance‑based multiplicity requires dissimilarity matrix uses Shannon‑type weighting. Use sig cap pairwise distances define two subunits considered distinct. distance matrix structure key understanding distance-based multiplicity. ’s distance matrix example:  Notice features within cluster (f1-f2 cluster , f3-f4 cluster B) smaller distances (smaller squares) compared distances clusters. Distance-based multiplicity quantifies diversity within clusters accounting functional/phylogenetic similarities. Smaller sig trims large distances, making subunits similar lowering functional/phylogenetic diversity; typically increases distance‑based multiplicity (less diversity lost clustering, relatively within‑cluster similarity accounted ).","code":"visualize_dist(diss, csize = 0.8, clegend = 0.5) res_sig08 <- divermeta(   abund,   clusters = clusters,   diss     = diss,   indices  = \"multiplicity_distance\",   sig      = 0.8)  res_sig10 <- divermeta(   abund,   clusters = clusters,   diss     = diss,   indices  = \"multiplicity_distance\",   sig      = 1.0)  merge(res_sig08, res_sig10, by = \"Sample\", suffixes = c(\"_sig0.8\",\"_sig1.0\")) #>   Sample multiplicity_distance_sig0.8 multiplicity_distance_sig1.0 #> 1     S1                     1.085995                    0.9735683 #> 2     S2                     1.008499                    0.9251559 #> 3     S3                     1.188623                    1.0508205"},{"path":"https://mycology-microbiology-center.github.io/divermeta/articles/divermeta.html","id":"metagenomic-alpha-diversity-index-mad","dir":"Articles","previous_headings":"About multiplicity index","what":"Metagenomic Alpha-Diversity Index (MAD)","title":"Introduction to divermeta","text":"Metagenomic Alpha-Diversity Index (MAD) another metric measuring within-cluster diversity. Unlike multiplicity indices, MAD incorporate element abundances decreases cluster size increases. available standalone function metagenomic.alpha.index(): Note: Unlike multiplicity, MAD account element abundances behaves differently cluster size increases. See manuscript detailed comparison MAD multiplicity indices.","code":"# Compute MAD # Note: MAD requires clusters and dissimilarity matrix, but doesn't use abundances # Since it doesn't use abundances, the value is the same regardless of sample mad_value <- metagenomic.alpha.index(   clust = clusters,   diss = diss ) mad_value #> [1] 0.575"},{"path":"https://mycology-microbiology-center.github.io/divermeta/articles/divermeta.html","id":"practical-tips","dir":"Articles","previous_headings":"","what":"Practical tips","title":"Introduction to divermeta","text":"Ensure clusters aligned rownames(abund); named vector robust. Provide diss scaled 0-1. Values sig capped internally. Choose q emphasize common vs. rare subunits; distance‑based multiplicity fixed Shannon‑type weighting.","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/articles/divermeta.html","id":"importing-data-from-thirdparty-tools-todo","dir":"Articles","previous_headings":"","what":"Importing data from third‑party tools (TODO)","title":"Introduction to divermeta","text":"TODO - add recipes importing outputs common pipelines/tools preparing data divermeta().","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/articles/divermeta.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session info","title":"Introduction to divermeta","text":"","code":"sessionInfo() #> R version 4.5.2 (2025-10-31) #> Platform: x86_64-pc-linux-gnu #> Running under: Ubuntu 24.04.3 LTS #>  #> Matrix products: default #> BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  #> LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0 #>  #> locale: #>  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        #>  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    #>  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           #> [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    #>  #> time zone: UTC #> tzcode source: system (glibc) #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] divermeta_0.0.3 #>  #> loaded via a namespace (and not attached): #>  [1] vctrs_0.7.1        cli_3.6.5          knitr_1.51         rlang_1.1.7        #>  [5] xfun_0.56          S7_0.2.1           textshaping_1.0.4  jsonlite_2.0.0     #>  [9] glue_1.8.0         htmltools_0.5.9    ragg_1.5.0         sass_0.4.10        #> [13] scales_1.4.0       rmarkdown_2.30     grid_4.5.2         evaluate_1.0.5     #> [17] jquerylib_0.1.4    fastmap_1.2.0      yaml_2.3.12        lifecycle_1.0.5    #> [21] compiler_4.5.2     RColorBrewer_1.1-3 fs_1.6.6           farver_2.1.2       #> [25] systemfonts_1.3.1  digest_0.6.39      R6_2.6.1           bslib_0.10.0       #> [29] withr_3.0.2        tools_4.5.2        gtable_0.3.6       pkgdown_2.2.0      #> [33] ggplot2_4.0.1      cachem_1.1.0       desc_1.4.3"},{"path":"https://mycology-microbiology-center.github.io/divermeta/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Felipe González-Casabianca. Author, maintainer. Vladimir Mikryukov. Author.","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"González-Casabianca F, Mikryukov V (2026). divermeta: Multiplicity index. R package version 0.0.3, https://mycology-microbiology-center.github.io/divermeta.","code":"@Manual{,   title = {divermeta: Multiplicity index},   author = {Felipe González-Casabianca and Vladimir Mikryukov},   year = {2026},   note = {R package version 0.0.3},   url = {https://mycology-microbiology-center.github.io/divermeta}, }"},{"path":"https://mycology-microbiology-center.github.io/divermeta/index.html","id":"divermeta","dir":"","previous_headings":"","what":"divermeta: Multiplicity index","title":"divermeta: Multiplicity index","text":"divermeta R package quantifying diversity hidden within clustered units metagenomic ecological analyses. implements multiplicity index, novel metric measures average diversity within clusters quantifies much diversity lost sequences features grouped operational units (e.g., OTUs, gene clusters, functional groups).","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/index.html","id":"what-is-multiplicity","dir":"","previous_headings":"","what":"What is multiplicity?","title":"divermeta: Multiplicity index","text":"metagenomic ecological studies, sequences typically clustered operational units simplify analysis. clustering necessary useful, inevitably obscures diversity exists within cluster. Multiplicity quantifies hidden diversity. answers question: “average, many distinct elements contained within cluster?” High multiplicity means clusters contain many diverse elements (e.g., multiple gene variants haplotypes) Low multiplicity means clusters dominated similar elements (e.g., nearly identical sequences within OTU) Multiplicity complements traditional diversity indices partitioning total diversity : -cluster diversity (traditional indices measure) Within-cluster diversity (multiplicity measures) partitioning helps researchers understand clustering choices affect diversity estimates can reveal important biological patterns otherwise remain hidden.","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"divermeta: Multiplicity index","text":"can install development version divermeta GitHub : using remotes:","code":"# install.packages(\"pak\") pak::pak(\"Mycology-Microbiology-Center/divermeta\") # install.packages(\"remotes\") remotes::install_github(\"Mycology-Microbiology-Center/divermeta\")"},{"path":"https://mycology-microbiology-center.github.io/divermeta/index.html","id":"quick-start","dir":"","previous_headings":"","what":"Quick start","title":"divermeta: Multiplicity index","text":"main function divermeta() computes multiplicity diversity indices across samples. ’s minimal example:","code":"library(divermeta)  # Abundance matrix: rows = features, columns = samples abund <- matrix(   c(10, 5,  8, 12,  6, 3,  4, 9),   nrow = 4,   ncol = 2,   dimnames = list(     c(\"gene1\", \"gene2\", \"gene3\", \"gene4\"),     c(\"Sample_A\", \"Sample_B\")   ) )  # Assign features to clusters clusters <- c(gene1 = \"Group_A\", gene2 = \"Group_A\",                gene3 = \"Group_B\", gene4 = \"Group_B\")  # Compute inventory multiplicity divermeta(abund, clusters = clusters, indices = \"multiplicity_inventory\") #>     Sample multiplicity_inventory #> 1 Sample_A               1.929710 #> 2 Sample_B               1.868481"},{"path":"https://mycology-microbiology-center.github.io/divermeta/index.html","id":"learn-more","dir":"","previous_headings":"","what":"Learn more","title":"divermeta: Multiplicity index","text":"detailed examples, use cases, technical documentation: Vignette: Comprehensive guide examples inventory distance-based multiplicity Function reference: Complete documentation functions parameters Manuscript: Theoretical background, mathematical foundations, real-world applications","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"divermeta: Multiplicity index","text":"use divermeta research, please cite: González-Casabianca F, Dulya O, Flores-Almaraz V, Tedersoo L, Mikryukov V. Multiplicity quantifies intra-cluster diversity metagenomic analysis // prep.","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/cluster_distance_matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Distance Matrix Between Clusters — cluster_distance_matrix","title":"Compute Distance Matrix Between Clusters — cluster_distance_matrix","text":"Computes distance matrix clusters based pairwise distances elements different clusters. Supports various linkage methods aggregating distances cluster members.","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/cluster_distance_matrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Distance Matrix Between Clusters — cluster_distance_matrix","text":"","code":"cluster_distance_matrix(   diss,   clust,   clust_ids_order,   method = \"sigma\",   sig = 1 )"},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/cluster_distance_matrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Distance Matrix Between Clusters — cluster_distance_matrix","text":"diss distance matrix dist object containing pairwise distances elements clust Integer factor vector cluster assignments element clust_ids_order Integer factor vector specifying order cluster IDs use output distance matrix method Character string specifying linkage method aggregating distances clusters. One : \"average\", \"min\", \"max\", \"sigma\". Sigma sets distances clusters value sig. Default \"sigma\". sig Numeric value specifying maximum distance threshold using \"sigma\" method. Distances greater sigma capped value. Default 1.","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/cluster_distance_matrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Distance Matrix Between Clusters — cluster_distance_matrix","text":"distance matrix dist object (matching input type) containing distances clusters. dimensions correspond length(clust_ids_order).","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/cluster_distance_matrix.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute Distance Matrix Between Clusters — cluster_distance_matrix","text":"function computes inter-cluster distances aggregating pairwise distances elements belonging different clusters. available linkage methods : \"average\": Mean distance cross-cluster pairs \"min\": Minimum distance cross-cluster pair \"max\": Maximum distance cross-cluster pair \"sigma\": Returns matrix inter-cluster distances set sigma (useful creating complete graphs) function preserves input type: diss dist object, output also dist object; full matrix, output full matrix.","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/cluster_distance_matrix.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Compute Distance Matrix Between Clusters — cluster_distance_matrix","text":"clust_ids_order parameter determines order clusters output distance matrix. useful want maintain specific cluster ordering rather using natural order cluster IDs found clust. using \"sigma\" method, inter-cluster distances set specified sigma value, creating complete graph clusters equally distant .","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/cluster_distance_matrix.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute Distance Matrix Between Clusters — cluster_distance_matrix","text":"","code":"# Create sample data set.seed(123) n <- 10 diss <- dist(matrix(rnorm(n * 3), ncol = 3)) clust <- c(1, 1, 2, 2, 3, 3, 4, 4, 1, 2) clust_ids <- sort(unique(clust))  # Compute cluster distances using different methods clust_dist_avg <- cluster_distance_matrix(diss, clust, clust_ids, \"average\") clust_dist_min <- cluster_distance_matrix(diss, clust, clust_ids, \"min\") clust_dist_max <- cluster_distance_matrix(diss, clust, clust_ids, \"max\") clust_dist_sigma <- cluster_distance_matrix(diss, clust, clust_ids, \"sigma\", sig = 2)  # Compare the results print(as.matrix(clust_dist_avg)) #>          1        2        3        4 #> 1 0.000000 1.863846 2.091610 2.487629 #> 2 1.863846 0.000000 2.130240 2.289524 #> 3 2.091610 2.130240 0.000000 3.049326 #> 4 2.487629 2.289524 3.049326 0.000000 print(as.matrix(clust_dist_min)) #>           1         2         3        4 #> 1 0.0000000 0.6430504 1.0645847 1.269369 #> 2 0.6430504 0.0000000 0.6771221 1.391801 #> 3 1.0645847 0.6771221 0.0000000 1.833059 #> 4 1.2693691 1.3918006 1.8330587 0.000000 print(as.matrix(clust_dist_max)) #>          1        2        3        4 #> 1 0.000000 2.877945 2.824485 3.488312 #> 2 2.877945 0.000000 4.292038 3.868997 #> 3 2.824485 4.292038 0.000000 5.133808 #> 4 3.488312 3.868997 5.133808 0.000000 print(clust_dist_sigma) #>   1 2 3 #> 2 2     #> 3 2 2   #> 4 2 2 2  # Use with full matrix input diss_matrix <- as.matrix(diss) clust_dist_matrix <- cluster_distance_matrix(diss_matrix, clust, clust_ids, \"average\")"},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/convert_to_dist_indices.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert Matrix Indices to Distance Vector Position — convert_to_dist_indices","title":"Convert Matrix Indices to Distance Vector Position — convert_to_dist_indices","text":"Converts row column indices full distance matrix corresponding position compact vector representation used R's dist objects. function maps (, j) matrix coordinates linear index k lower-triangular distance vector.","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/convert_to_dist_indices.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert Matrix Indices to Distance Vector Position — convert_to_dist_indices","text":"","code":"convert_to_dist_indices(i, j, n)"},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/convert_to_dist_indices.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert Matrix Indices to Distance Vector Position — convert_to_dist_indices","text":"Integer vector row indices (less j) j Integer vector column indices (greater ) n Integer, size square distance matrix (number objects)","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/convert_to_dist_indices.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert Matrix Indices to Distance Vector Position — convert_to_dist_indices","text":"Integer vector length j, containing positions distance vector corresponding input matrix indices.","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/convert_to_dist_indices.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Convert Matrix Indices to Distance Vector Position — convert_to_dist_indices","text":"R's dist objects store distance matrices compact form storing lower triangle (excluding diagonal) vector. storage order follows: Row-major order lower triangle: (2,1), (3,1), (3,2), (4,1), (4,2), (4,3), ... n×n matrix, vector length n×(n-1)/2 formula used : \\(k = (-1) \\times n - \\frac{(-1) \\times }{2} + (j-)\\) \\(< j\\)","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/convert_to_dist_indices.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Convert Matrix Indices to Distance Vector Position — convert_to_dist_indices","text":"function assumes < j input pairs. > j, result incorrect corresponds upper triangle, stored dist objects. function check valid indices.","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/dist_quadratic_form.html","id":null,"dir":"Reference","previous_headings":"","what":"Quadratic Form for a Distance Object — dist_quadratic_form","title":"Quadratic Form for a Distance Object — dist_quadratic_form","text":"Computes quadratic form \\(\\sum_{,j} 2 p_i p_j m_{ij}\\) vector p dist object m. equivalent \\(P^T M P\\), M full distance matrix, without explicitly constructing full matrix.","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/dist_quadratic_form.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Quadratic Form for a Distance Object — dist_quadratic_form","text":"","code":"dist_quadratic_form(p, diss)"},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/dist_quadratic_form.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Quadratic Form for a Distance Object — dist_quadratic_form","text":"p Numeric vector length \\( n \\), representing weights abundances. diss dist object size \\( n \\) (returned vegdist dist), containing pairwise distances observations.","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/dist_quadratic_form.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Quadratic Form for a Distance Object — dist_quadratic_form","text":"numeric scalar, value quadratic form \\(P^T M P\\).","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/dist_quadratic_form.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Quadratic Form for a Distance Object — dist_quadratic_form","text":"function uses fact dist object stores lower triangle distance matrix column-major order. removes zero entries constructs pairs indices corresponding storage order computes sum efficiently.","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/dist_quadratic_form.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Quadratic Form for a Distance Object — dist_quadratic_form","text":"","code":"set.seed(123) p <- runif(5)  # abundances diss <- stats::dist(matrix(runif(5 * 3), ncol = 3)) # distance matrix dist_quadratic_form(p, diss) #> [1] 5.89332"},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/divermeta.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate diversity and multiplicity indices across samples — divermeta","title":"Estimate diversity and multiplicity indices across samples — divermeta","text":"Estimate several diversity multiplicity indices many samples . Abundances provided samples columns features (species/OTUs/genes) rows. supplied, dissimilarity matrix must correspond feature names.","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/divermeta.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate diversity and multiplicity indices across samples — divermeta","text":"","code":"divermeta(   abund,   diss = NULL,   indices = c(\"multiplicity_inventory\"),   clusters = NULL,   q = 1,   sig = 1,   method = \"sigma\",   normalize = FALSE )"},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/divermeta.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate diversity and multiplicity indices across samples — divermeta","text":"abund Numeric matrix data.frame abundances samples columns features rows. diss Optional numeric dissimilarity matrix dist object among features; square row/column names matching rownames(abund) present. indices Character vector index names compute (see list ). clusters Optional vector/factor cluster memberships feature (row abund). q Numeric order Hill-number based indices (used FD_q multiplicity_inventory). Default 1. sig Numeric cutoff σ distance-based measures (used FD_sigma multiplicity_distance). Default 1. method Character string specifying linkage method aggregating distances clusters. One : \"average\", \"min\", \"max\", \"sigma\". Sigma sets distances clusters value sig. Default \"sigma\". normalize Logical indicating whether index values normalized [0, 1] dividing column maximum value. Useful comparing indices different scales. Default FALSE.","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/divermeta.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate diversity and multiplicity indices across samples — divermeta","text":"data.frame one row per sample one column per requested index. Empty samples (zero abundances) return NA indices.","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/divermeta.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate diversity and multiplicity indices across samples — divermeta","text":"Indices available (use labels indices): \"multiplicity_inventory\": inventory multiplicity \\(^{q}M\\) (order \\(q\\)) \"multiplicity_distance\": distance-based multiplicity \\(\\delta M_{\\sigma}\\) (cutoff sig) \"raoQ\": Rao quadratic entropy \\(Q\\) \"FD_sigma\": distance-based functional diversity \\(\\delta D_{\\sigma}\\) (cutoff sig) \"FD_q\": distance-based functional diversity \\(^{q}FD\\) (order \\(q\\)) \"redundancy\": functional redundancy \\(Re\\) Notes: Indices use dissimilarities (multiplicity_distance, raoQ, FD_sigma, FD_q, redundancy) require diss. Indices use clustering (multiplicity_inventory, multiplicity_distance) require clusters (length/order feature rows).","code":""},{"path":[]},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/divermeta.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate diversity and multiplicity indices across samples — divermeta","text":"","code":"# Abundance matrix: rows = features, columns = samples species <- c(\"s1\", \"s2\", \"s3\", \"s4\") samples <- c(\"Sample1\", \"Sample2\", \"Sample3\") abund <- matrix(   c(     10, 5,  0, # s1     0,  8, 12, # s2     4,  3,  7, # s3     6,  0,  9 # s4   ),   nrow = length(species),   ncol = length(samples),   byrow = TRUE,   dimnames = list(species, samples) )  # Dissimilarity matrix among features (0-1), names must match abund rownames diss <- matrix(   c(     0.0, 0.2, 0.7, 1.0,     0.2, 0.0, 0.6, 0.9,     0.7, 0.6, 0.0, 0.4,     1.0, 0.9, 0.4, 0.0   ),   nrow = length(species),   ncol = length(species),   byrow = TRUE,   dimnames = list(species, species) )  # Clusters per feature (used by multiplicity_* indices) clusters <- c(s1 = \"A\", s2 = \"A\", s3 = \"B\", s4 = \"B\")  ## Run divermeta divermeta(abund,   clusters = clusters,   diss = diss,   q = 1,   sig = 0.8,   indices = c(\"multiplicity_inventory\", \"multiplicity_distance\", \"raoQ\", \"redundancy\") ) #>    Sample multiplicity_inventory multiplicity_distance      raoQ redundancy #> 1 Sample1               1.400047              1.075269 0.4880000  0.1320000 #> 2 Sample2               1.718327              1.024460 0.2570312  0.3601563 #> 3 Sample3               1.479358              1.055409 0.4408163  0.2096939"},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/diversity.functional.html","id":null,"dir":"Reference","previous_headings":"","what":"Distance-based functional diversity (q = 1) (Chiu & Chao 2014) — diversity.functional","title":"Distance-based functional diversity (q = 1) (Chiu & Chao 2014) — diversity.functional","text":"Computes distance-based functional diversity \\(\\delta D_{\\sigma}\\) following Chiu & Chao (2014) Shannon-type weighting (order \\(q = 1\\)). Pairwise distances capped cutoff \\(\\sigma\\).","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/diversity.functional.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Distance-based functional diversity (q = 1) (Chiu & Chao 2014) — diversity.functional","text":"","code":"diversity.functional(ab, diss, sig = 1)"},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/diversity.functional.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Distance-based functional diversity (q = 1) (Chiu & Chao 2014) — diversity.functional","text":"ab Numeric vector element abundances. diss Numeric matrix dist object pairwise dissimilarities among elements. sig Numeric cutoff \\(\\sigma\\) two units considered different (default 1).","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/diversity.functional.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Distance-based functional diversity (q = 1) (Chiu & Chao 2014) — diversity.functional","text":"Numeric scalar, distance-based functional diversity \\(\\delta D_{\\sigma}\\).","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/diversity.functional.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Distance-based functional diversity (q = 1) (Chiu & Chao 2014) — diversity.functional","text":"Chiu CH, Chao (2014) Distance-based functional diversity measures decomposition: framework based Hill numbers. PLOS ONE 9(7). doi:10.1371/journal.pone.0100014 . https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0100014","code":""},{"path":[]},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/diversity.functional.traditional.html","id":null,"dir":"Reference","previous_headings":"","what":"Distance-based functional diversity (order q) (Chiu & Chao 2014) — diversity.functional.traditional","title":"Distance-based functional diversity (order q) (Chiu & Chao 2014) — diversity.functional.traditional","text":"Computes distance-based functional diversity \\(^{q}FD\\) following Chiu & Chao (2014). corresponds D(Q) paper \\(^{q}FD\\) divermeta manuscript. \\(q = 1\\), approximation used internally.","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/diversity.functional.traditional.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Distance-based functional diversity (order q) (Chiu & Chao 2014) — diversity.functional.traditional","text":"","code":"diversity.functional.traditional(ab, diss, q = 1)"},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/diversity.functional.traditional.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Distance-based functional diversity (order q) (Chiu & Chao 2014) — diversity.functional.traditional","text":"ab Numeric vector element abundances. diss Numeric matrix pairwise dissimilarities among elements. q Numeric order Hill number (non-negative).","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/diversity.functional.traditional.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Distance-based functional diversity (order q) (Chiu & Chao 2014) — diversity.functional.traditional","text":"Numeric scalar, distance-based functional diversity \\(^{q}FD\\).","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/diversity.functional.traditional.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Distance-based functional diversity (order q) (Chiu & Chao 2014) — diversity.functional.traditional","text":"Chiu CH, Chao (2014) Distance-based functional diversity measures decomposition: framework based Hill numbers. PLOS ONE 9(7). doi:10.1371/journal.pone.0100014 . https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0100014","code":""},{"path":[]},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/metagenomic.alpha.index.html","id":null,"dir":"Reference","previous_headings":"","what":"Metagenomic Alpha-Diversity Index (MAD) (Finn 2024) — metagenomic.alpha.index","title":"Metagenomic Alpha-Diversity Index (MAD) (Finn 2024) — metagenomic.alpha.index","text":"Computes Metagenomic Alpha-Diversity Index (MAD), metric measures average dissimilarity elements (e.g., protein-encoding genes) within clusters relative cluster representatives. Unlike multiplicity, MAD account element abundances decreases number elements per cluster increases.","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/metagenomic.alpha.index.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Metagenomic Alpha-Diversity Index (MAD) (Finn 2024) — metagenomic.alpha.index","text":"","code":"metagenomic.alpha.index(clust, diss, representatives = NULL)"},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/metagenomic.alpha.index.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Metagenomic Alpha-Diversity Index (MAD) (Finn 2024) — metagenomic.alpha.index","text":"clust Vector factor cluster memberships element (e.g., gene). Must length number rows/columns diss. diss Numeric square matrix pairwise dissimilarities among elements. scaled range [0, 1], 0 indicates identical elements 1 indicates maximally different elements. representatives Optional named vector mapping cluster names index (position) representative element cluster. NULL (default), first element cluster used representative.","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/metagenomic.alpha.index.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Metagenomic Alpha-Diversity Index (MAD) (Finn 2024) — metagenomic.alpha.index","text":"Numeric scalar, Metagenomic Alpha-Diversity Index (MAD). Higher values indicate greater average dissimilarity within clusters.","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/metagenomic.alpha.index.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Metagenomic Alpha-Diversity Index (MAD) (Finn 2024) — metagenomic.alpha.index","text":"Note: Unlike multiplicity indices, MAD incorporate element abundances decreases cluster size increases, may reflect biological complexity.","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/metagenomic.alpha.index.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Metagenomic Alpha-Diversity Index (MAD) (Finn 2024) — metagenomic.alpha.index","text":"Finn DR (2024) metagenomic alpha-diversity index microbial functional biodiversity. FEMS Microbiology Ecology 100(3):fiae019. doi:10.1093/femsec/fiae019","code":""},{"path":[]},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/metagenomic.alpha.index.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Metagenomic Alpha-Diversity Index (MAD) (Finn 2024) — metagenomic.alpha.index","text":"","code":"# Example: Compute MAD for gene clusters clust <- c(1, 1, 2, 2, 2, 3) diss <- matrix(c(   0.0, 0.2, 0.8, 0.9, 0.9, 0.9,   0.2, 0.0, 0.8, 0.9, 0.9, 0.9,   0.8, 0.8, 0.0, 0.1, 0.15, 0.9,   0.9, 0.9, 0.1, 0.0, 0.12, 0.9,   0.9, 0.9, 0.15, 0.12, 0.0, 0.9,   0.9, 0.9, 0.9, 0.9, 0.9, 0.0 ), nrow = 6, byrow = TRUE)  # Use default (first element as representative) metagenomic.alpha.index(clust, diss) #> [1] 0.5305556  # Specify representatives explicitly reps <- c(\"1\" = 1, \"2\" = 3, \"3\" = 6) metagenomic.alpha.index(clust, diss, representatives = reps) #> [1] 0.5305556"},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/multiplicity.distance.by_blocks.html","id":null,"dir":"Reference","previous_headings":"","what":"Distance-based multiplicity by blocks — multiplicity.distance.by_blocks","title":"Distance-based multiplicity by blocks — multiplicity.distance.by_blocks","text":"Computes distance-based multiplicity \\(\\delta M_{\\sigma}\\) compact three-column distance table. efficient implementation large datasets storing full distance matrix memory-intensive. Distances elements different clusters assumed equal \\(\\sigma\\) (maximally different).","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/multiplicity.distance.by_blocks.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Distance-based multiplicity by blocks — multiplicity.distance.by_blocks","text":"","code":"multiplicity.distance.by_blocks(ids, ab, diss_frame, clust, sigma = 1)"},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/multiplicity.distance.by_blocks.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Distance-based multiplicity by blocks — multiplicity.distance.by_blocks","text":"ids Character integer vector element identifiers (length n). Must match identifiers used diss_frame. ab Numeric vector pre-clustering abundances (length n, order ids). diss_frame Data frame columns ID1, ID2, Distance containing pairwise distances unique pairs elements. include within-cluster pairs pairs distances less sigma; cross-cluster distances automatically set sigma. clust Vector factor cluster memberships element (length n, order ids). sigma Numeric cutoff \\(\\sigma\\) (default 1) two units considered maximally different. distances diss_frame greater sigma capped, distances elements different clusters set sigma.","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/multiplicity.distance.by_blocks.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Distance-based multiplicity by blocks — multiplicity.distance.by_blocks","text":"Numeric scalar, distance-based multiplicity \\(\\delta M_{\\sigma}\\).","code":""},{"path":[]},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/multiplicity.distance.by_blocks.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Distance-based multiplicity by blocks — multiplicity.distance.by_blocks","text":"","code":"# Example: Compute multiplicity from a distance table ids <- c(\"elem1\", \"elem2\", \"elem3\", \"elem4\") ab <- c(10, 15, 20, 25) clust <- c(1, 1, 2, 2)  # Distance table: only within-cluster pairs (cross-cluster assumed = sigma) diss_frame <- data.frame(   ID1 = c(\"elem1\", \"elem3\"),   ID2 = c(\"elem2\", \"elem4\"),   Distance = c(0.3, 0.4),   stringsAsFactors = FALSE )  multiplicity.distance.by_blocks(ids, ab, diss_frame, clust, sigma = 1) #> [1] 1.226852"},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/multiplicity.distance.html","id":null,"dir":"Reference","previous_headings":"","what":"Distance-based multiplicity — multiplicity.distance","title":"Distance-based multiplicity — multiplicity.distance","text":"Computes distance-based multiplicity \\(\\delta M_{\\sigma}\\) ratio distance-based diversity vs clustering, using cutoff \\(\\sigma\\) cap pairwise distances. index quantifies diversity lost clustering elements operational units, incorporating pairwise dissimilarities (e.g., genetic, functional, phylogenetic distances) among elements.","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/multiplicity.distance.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Distance-based multiplicity — multiplicity.distance","text":"","code":"multiplicity.distance(   ab,   diss,   clust,   method = \"sigma\",   sig = 1,   clust_ids_order = NULL,   diss_clust = NULL )"},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/multiplicity.distance.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Distance-based multiplicity — multiplicity.distance","text":"ab Numeric vector element abundances clustering. diss Numeric matrix dist object pairwise dissimilarities among elements clustering. Must square match length ab. clust Vector factor cluster memberships element ab. Must length ab. method Character string specifying linkage method aggregating distances clusters. One : \"average\", \"min\", \"max\", \"sigma\". Sigma sets distances clusters value sig. Default \"sigma\". sig Numeric cutoff \\(\\sigma\\) (default 1) defining threshold distance two units considered maximally different. distances greater sig capped sig. parameter chosen based biological meaning distances dataset (e.g., maximum expected genetic distance, functional dissimilarity threshold). clust_ids_order Integer factor vector specifying order cluster IDs appear output. NULL (default), uses natural order unique cluster IDs found clust. diss_clust Numeric matrix dist object pairwise dissimilarities among clusters clustering. used method \"custom\". Default NULL.","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/multiplicity.distance.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Distance-based multiplicity — multiplicity.distance","text":"Numeric scalar, distance-based multiplicity \\(\\delta M_{\\sigma}\\). value represents effective number functionally distinct elements per cluster. value 1 indicates minimal functional diversity within clusters, higher values indicate greater functional diversity lost clustering.","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/multiplicity.distance.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Distance-based multiplicity — multiplicity.distance","text":"Unlike inventory multiplicity, distance-based multiplicity defined \\(q = 1\\) (Shannon-type weighting), meaning elements weighted proportionally abundance. function supports several methods computing inter-cluster distances: \"sigma\": inter-cluster distances set sig, creating maximally different clusters (default) \"average\": Mean distance cross-cluster element pairs \"min\": Minimum distance cross-cluster element pair \"max\": Maximum distance cross-cluster element pair \"custom\": Use pre-computed cluster distance matrix provided via diss_clust using \"custom\" method, must provide diss_clust ensure dimensions match number clusters. clust_ids_order parameter determines cluster abundances aligned distance matrix.","code":""},{"path":[]},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/multiplicity.distance.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Distance-based multiplicity — multiplicity.distance","text":"","code":"# Example 1: Using sigma method (default) # Two clusters with maximally different clusters ab <- c(10, 10, 10, 10)  # 4 elements clust <- c(1, 1, 2, 2)    # 2 clusters diss <- matrix(c(   0.0, 0.3, 1.0, 1.0,   0.3, 0.0, 1.0, 1.0,   1.0, 1.0, 0.0, 0.4,   1.0, 1.0, 0.4, 0.0 ), nrow = 4, byrow = TRUE)  multiplicity.distance(ab, diss, clust, method = \"sigma\", sig = 1) #> [1] 1.212121  # Example 2: Using average linkage # Compute cluster distances as mean of cross-cluster element distances multiplicity.distance(ab, diss, clust, method = \"average\", sig = 1) #> [1] 1.636364  # Example 3: Using custom cluster distances # Provide pre-computed cluster distance matrix ab <- c(10, 10, 10, 10) clust <- c(\"A\", \"A\", \"B\", \"B\") clust_ids <- c(\"A\", \"B\") diss <- dist(matrix(rnorm(4 * 3), ncol = 3)) diss_clust <- matrix(c(0, 0.8, 0.8, 0), nrow = 2)  multiplicity.distance(   ab, diss, clust,   method = \"custom\",   diss_clust = diss_clust,   clust_ids_order = clust_ids ) #> [1] 2.4  # Example 4: Low diversity within clusters # Elements within clusters are functionally similar (distance ~0) diss_low <- matrix(c(   0.0, 0.05, 1.0, 1.0,   0.05, 0.0, 1.0, 1.0,   1.0, 1.0, 0.0, 0.05,   1.0, 1.0, 0.05, 0.0 ), nrow = 4, byrow = TRUE)  multiplicity.distance(ab, diss_low, clust, method = \"sigma\", sig = 1) #> [1] 1.025641"},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/multiplicity.inventory.html","id":null,"dir":"Reference","previous_headings":"","what":"Inventory multiplicity — multiplicity.inventory","title":"Inventory multiplicity — multiplicity.inventory","text":"Computes inventory multiplicity \\(^{q}M\\), within-cluster diversity component Hill-number partitioning. summarizes average diversity inside clusters given element abundances cluster memberships. Use q control abundance weighting (e.g., q = 0 richness-like, q = 1 Shannon-type).","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/multiplicity.inventory.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Inventory multiplicity — multiplicity.inventory","text":"","code":"multiplicity.inventory(ab, clust, q = 1)"},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/multiplicity.inventory.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Inventory multiplicity — multiplicity.inventory","text":"ab Numeric vector element (subunit) abundances. Elements zero abundance automatically removed computation. clust Vector factor cluster memberships element ab. Must length ab q Numeric order Hill number (default 1). Controls abundance weighting: q = 0 Richness-like weighting (elements weighted equally) q = 1 Shannon-type weighting (default, proportional abundance) q = 2 Simpson-type weighting (emphasizes abundant elements) Must non-negative.","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/multiplicity.inventory.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Inventory multiplicity — multiplicity.inventory","text":"Numeric scalar, inventory multiplicity \\(^{q}M\\). value can interpreted effective number equally abundant elements per cluster. value 1 indicates cluster contains essentially one element (diversity lost), higher values indicate greater intra-cluster diversity.","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/multiplicity.inventory.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Inventory multiplicity — multiplicity.inventory","text":"Hill MO (1973) Diversity evenness: unifying notation consequences. Ecology 54(2):427-432. doi:10.2307/1934352 Jost L (2007) Partitioning diversity independent alpha beta components. Ecology 88(10):2427-2439. doi:10.1890/06-1736.1","code":""},{"path":[]},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/multiplicity.inventory.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Inventory multiplicity — multiplicity.inventory","text":"","code":"# Example 1: High multiplicity (many diverse elements per cluster) # Three clusters, each with 3 equally abundant elements ab <- rep(10, 9) clust <- c(rep(1, 3), rep(2, 3), rep(3, 3)) multiplicity.inventory(ab, clust) #> [1] 3 # Result: 3 (each cluster has effective diversity of 3)  # Example 2: Low multiplicity (one element per cluster) # Three clusters, each with one element ab <- c(10, 20, 30) clust <- c(1, 2, 3) multiplicity.inventory(ab, clust) #> [1] 1 # Result: 1 (no diversity lost, each cluster is a single element)  # Example 3: Unequal abundances within clusters ab <- c(10, 5, 2,  # cluster 1: unequal abundances         8, 8, 8,    # cluster 2: equal abundances         20, 1)      # cluster 3: very unequal abundances clust <- c(rep(1, 3), rep(2, 3), rep(3, 2)) multiplicity.inventory(ab, clust, q = 1) #> [1] 2.103125  # Example 4: Using different q values ab <- rep(1:12) clust <- c(rep(1, 4), rep(2, 4), rep(3, 4)) multiplicity.inventory(ab, clust, q = 0)  # Richness-like #> [1] 4 multiplicity.inventory(ab, clust, q = 1)  # Shannon-type (default) #> [1] 3.914214 multiplicity.inventory(ab, clust, q = 2)  # Simpson-type #> [1] 3.907692"},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/raoQuadratic.html","id":null,"dir":"Reference","previous_headings":"","what":"Rao quadratic entropy (Q) (Rao 1982) — raoQuadratic","title":"Rao quadratic entropy (Q) (Rao 1982) — raoQuadratic","text":"Computes Rao quadratic entropy \\(Q\\), diversity measure accounts element abundances pairwise dissimilarities.","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/raoQuadratic.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Rao quadratic entropy (Q) (Rao 1982) — raoQuadratic","text":"","code":"raoQuadratic(ab, diss)"},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/raoQuadratic.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Rao quadratic entropy (Q) (Rao 1982) — raoQuadratic","text":"ab Numeric vector element abundances. diss Numeric square matrix dist object pairwise dissimilarities among elements.","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/raoQuadratic.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Rao quadratic entropy (Q) (Rao 1982) — raoQuadratic","text":"Numeric scalar, Rao quadratic entropy \\(Q\\).","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/raoQuadratic.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Rao quadratic entropy (Q) (Rao 1982) — raoQuadratic","text":"Rao CR (1982) Diversity dissimilarity coefficients: unified approach. Theoretical Population Biology, 21. doi:10.1016/0040-5809(82)90004-1 .","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/redundancy.html","id":null,"dir":"Reference","previous_headings":"","what":"Functional redundancy (Re) (Ricotta & Pavoine 2025) — redundancy","title":"Functional redundancy (Re) (Ricotta & Pavoine 2025) — redundancy","text":"Computes functional redundancy \\(Re\\), measure degree distinct elements functionally similar given abundances pairwise dissimilarities. implementation follows Simpson–Rao family corresponds q = 2 case.","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/redundancy.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Functional redundancy (Re) (Ricotta & Pavoine 2025) — redundancy","text":"","code":"redundancy(ab, diss)"},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/redundancy.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Functional redundancy (Re) (Ricotta & Pavoine 2025) — redundancy","text":"ab Numeric vector element abundances. diss Numeric square matrix dist object pairwise dissimilarities among elements scaled range [0, 1].","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/redundancy.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Functional redundancy (Re) (Ricotta & Pavoine 2025) — redundancy","text":"Numeric scalar, functional redundancy Re.","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/redundancy.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Functional redundancy (Re) (Ricotta & Pavoine 2025) — redundancy","text":"Ricotta C, Pavoine S (2025) functional diversity, redundancy, rarity, originality actually measure? theoretical guide ecologists conservationists. Ecological Complexity 61. doi:10.1016/j.ecocom.2025.101116 . https://www.sciencedirect.com/science/article/pii/S1476945X25000017 Rao CR (1982) Diversity dissimilarity coefficients: unified approach. Theoretical Population Biology 21. doi:10.1016/0040-5809(82)90004-1 .","code":""},{"path":[]},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/visualize_abundance.html","id":null,"dir":"Reference","previous_headings":"","what":"Visualize an abundance matrix as a sized-tile plot — visualize_abundance","title":"Visualize an abundance matrix as a sized-tile plot — visualize_abundance","text":"Creates compact visualization abundance matrix cell drawn square whose area proportional abundance value. Rows features (OTUs, species, genes, etc.) columns samples.","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/visualize_abundance.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Visualize an abundance matrix as a sized-tile plot — visualize_abundance","text":"","code":"visualize_abundance(   abund,   feature.labels = NA,   sample.labels = NA,   clabel.row = 1,   clabel.col = 1,   csize = 1,   clegend = 1,   grid = TRUE,   transform = c(\"identity\", \"log1p\", \"sqrt\") )"},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/visualize_abundance.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Visualize an abundance matrix as a sized-tile plot — visualize_abundance","text":"abund numeric matrix data.frame features rows samples columns. feature.labels Optional character vector row labels (features). NA (default), labels taken rownames(abund) available, otherwise sequential indices used. sample.labels Optional character vector column labels (samples). NA (default), labels taken colnames(abund) available, otherwise sequential indices used. clabel.row Numeric multiplier relative size y-axis text. clabel.col Numeric multiplier relative size x-axis text. csize Numeric multiplier controlling maximum symbol (tile) size. clegend greater 0, size legend shown; otherwise legend hidden. grid Logical; whether draw light grid behind tiles. transform One \"identity\", \"log1p\", \"sqrt\" indicating simple non-negative transform applied abundances sizing.","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/visualize_abundance.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Visualize an abundance matrix as a sized-tile plot — visualize_abundance","text":"ggplot2 object representing visualization.","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/visualize_abundance.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Visualize an abundance matrix as a sized-tile plot — visualize_abundance","text":"Values visualized magnitude; larger values produce larger squares. first row (first feature) displayed top. transform = \"log1p\" \"sqrt\", non-negative guards applied via pmax(0, x) prior transform. Legend tick labels shown original (back-transformed) abundance scale readability.","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/visualize_abundance.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Visualize an abundance matrix as a sized-tile plot — visualize_abundance","text":"","code":"set.seed(1) abund <- matrix(     data = floor(rlnorm(n = 5 * 4, meanlog = 1, sdlog = 2.5)),   nrow = 5, ncol = 4) rownames(abund) <- paste0(\"feat\", 1:5) colnames(abund) <- paste0(\"S\", 1:4) visualize_abundance(abund)"},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/visualize_dist.html","id":null,"dir":"Reference","previous_headings":"","what":"Visualize a distance matrix as a sized-tile plot — visualize_dist","title":"Visualize a distance matrix as a sized-tile plot — visualize_dist","text":"Creates compact visualization distance dissimilarity matrix cell drawn square whose area proportional magnitude corresponding value. Labels taken input available can customized.","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/visualize_dist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Visualize a distance matrix as a sized-tile plot — visualize_dist","text":"","code":"visualize_dist(   diss,   row.labels = NA,   col.labels = NA,   clabel.row = 1,   clabel.col = 1,   csize = 1,   clegend = 1,   grid = TRUE )"},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/visualize_dist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Visualize a distance matrix as a sized-tile plot — visualize_dist","text":"diss distance object (class dist), numeric matrix, data.frame containing pairwise distances/dissimilarities. row.labels Optional character vector row labels. NA (default), labels taken diss available, otherwise sequential indices used. col.labels Optional character vector column labels. NA (default), labels taken diss available, otherwise sequential indices used. clabel.row Numeric multiplier relative size y-axis text. clabel.col Numeric multiplier relative size x-axis text. csize Numeric multiplier controlling maximum symbol (tile) size. clegend greater 0, size legend shown; otherwise legend hidden. grid Logical; whether draw light grid behind tiles.","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/visualize_dist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Visualize a distance matrix as a sized-tile plot — visualize_dist","text":"ggplot2 object representing visualization.","code":""},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/visualize_dist.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Visualize a distance matrix as a sized-tile plot — visualize_dist","text":"diss dist object, labels taken Labels attribute present. Values visualized absolute magnitude; larger values produce larger squares. first row displayed top.","code":""},{"path":[]},{"path":"https://mycology-microbiology-center.github.io/divermeta/reference/visualize_dist.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Visualize a distance matrix as a sized-tile plot — visualize_dist","text":"","code":"x <- 1:10 names(x) <- LETTERS[1:10] diss <- stats::dist(x) visualize_dist(diss)"}]
