% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/support_functions.R
\name{cluster_distance_matrix}
\alias{cluster_distance_matrix}
\title{Compute Distance Matrix Between Clusters}
\usage{
cluster_distance_matrix(
  diss,
  clust,
  clust_ids_order,
  method = "sigma",
  sig = 1
)
}
\arguments{
\item{diss}{A distance matrix or \code{dist} object containing pairwise
distances between all elements}

\item{clust}{Integer or factor vector of cluster assignments for each element}

\item{clust_ids_order}{Integer or factor vector specifying the order of
cluster IDs to use in the output distance matrix}

\item{method}{Character string specifying the linkage method for
aggregating distances between clusters. One of: "average", "min",
"max", or "sigma". Sigma sets all distances between clusters to be
of value \code{sig}. Default is "sigma".}

\item{sig}{Numeric value specifying the maximum distance threshold
when using the "sigma" method. Distances greater than sigma are
capped at this value. Default is 1.}
}
\value{
A distance matrix or \code{dist} object (matching the input type)
containing distances between clusters. The dimensions correspond to
\code{length(clust_ids_order)}.
}
\description{
Computes a distance matrix between clusters based on pairwise distances
between elements in different clusters. Supports various linkage methods
for aggregating distances between cluster members.
}
\details{
This function computes inter-cluster distances by aggregating all pairwise
distances between elements belonging to different clusters. The available
linkage methods are:
\itemize{
\item \code{"average"}: Mean distance between all cross-cluster pairs
\item \code{"min"}: Minimum distance between any cross-cluster pair
\item \code{"max"}: Maximum distance between any cross-cluster pair
\item \code{"sigma"}: Returns a matrix where all inter-cluster distances
are set to \code{sigma} (useful for creating complete graphs)
}

The function preserves the input type: if \code{diss} is a \code{dist} object,
the output will also be a \code{dist} object; if it's a full matrix, the
output will be a full matrix.
}
\note{
The \code{clust_ids_order} parameter determines the order of clusters in the
output distance matrix. This is useful when you want to maintain a specific
cluster ordering rather than using the natural order of cluster IDs found
in \code{clust}.

When using the "sigma" method, all inter-cluster distances are set to the
specified sigma value, creating a complete graph where all clusters are
equally distant from each other.
}
\examples{
# Create sample data
set.seed(123)
n <- 10
diss <- dist(matrix(rnorm(n * 3), ncol = 3))
clust <- c(1, 1, 2, 2, 3, 3, 4, 4, 1, 2)
clust_ids <- sort(unique(clust))

# Compute cluster distances using different methods
clust_dist_avg <- cluster_distance_matrix(diss, clust, clust_ids, "average")
clust_dist_min <- cluster_distance_matrix(diss, clust, clust_ids, "min")
clust_dist_max <- cluster_distance_matrix(diss, clust, clust_ids, "max")
clust_dist_sigma <- cluster_distance_matrix(diss, clust, clust_ids, "sigma", sig = 2)

# Compare the results
print(as.matrix(clust_dist_avg))
print(as.matrix(clust_dist_min))
print(as.matrix(clust_dist_max))
print(clust_dist_sigma)

# Use with full matrix input
diss_matrix <- as.matrix(diss)
clust_dist_matrix <- cluster_distance_matrix(diss_matrix, clust, clust_ids, "average")


}
