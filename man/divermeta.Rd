% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/divermeta.R
\name{divermeta}
\alias{divermeta}
\title{Estimate diversity and multiplicity indices across samples}
\usage{
divermeta(
  abund,
  diss = NULL,
  indices = c("multiplicity_inventory"),
  clusters = NULL,
  q = 1,
  sig = 1,
  method = "sigma",
  normalize = FALSE
)
}
\arguments{
\item{abund}{Numeric matrix or data.frame of abundances with samples in columns
and features in rows.}

\item{diss}{Optional numeric dissimilarity matrix or \code{dist} object among features; square with
row/column names matching \code{rownames(abund)} when present.}

\item{indices}{Character vector of index names to compute (see list above).}

\item{clusters}{Optional vector/factor of cluster memberships for each feature
(row of \code{abund}).}

\item{q}{Numeric order for Hill-number based indices (used by \code{FD_q} and
\code{multiplicity_inventory}). Default \code{1}.}

\item{sig}{Numeric cutoff \code{Ïƒ} for distance-based measures (used by
\code{FD_sigma} and \code{multiplicity_distance}). Default \code{1}.}

\item{method}{Character string specifying the linkage method for
aggregating distances between clusters. One of: "average", "min",
"max", or "sigma". Sigma sets all distances between clusters to be
of value \code{sig}. Default is "sigma".}

\item{normalize}{Logical indicating whether index values should be normalized to [0, 1]
by dividing each column by its maximum value. Useful for comparing indices with
different scales. Default \code{FALSE}.}
}
\value{
data.frame with one row per sample and one column per requested index.
Empty samples (all zero abundances) return \code{NA} for all indices.
}
\description{
Estimate several diversity and multiplicity indices for many samples at once.
Abundances are provided with samples in columns and features (species/OTUs/genes)
in rows. If supplied, the dissimilarity matrix must correspond to feature names.
}
\details{
Indices available (use these labels in \code{indices}):
\itemize{
\item "multiplicity_inventory": inventory multiplicity \eqn{^{q}M}{M^q} (order \eqn{q}{q})
\item "multiplicity_distance": distance-based multiplicity \eqn{\delta M_{\sigma}}{delta M_sigma} (cutoff \code{sig})
\item "raoQ": Rao quadratic entropy \eqn{Q}{Q}
\item "FD_sigma": distance-based functional diversity \eqn{\delta D_{\sigma}}{delta D_sigma} (cutoff \code{sig})
\item "FD_q": distance-based functional diversity \eqn{^{q}FD}{FD^q} (order \eqn{q}{q})
\item "redundancy": functional redundancy \eqn{Re}{Re}
}

Notes:
\itemize{
\item Indices that use dissimilarities (\code{multiplicity_distance}, \code{raoQ}, \code{FD_sigma},
\code{FD_q}, \code{redundancy}) require \code{diss}.
\item Indices that use clustering (\code{multiplicity_inventory}, \code{multiplicity_distance})
require \code{clusters} (same length/order as feature rows).
}
}
\examples{

# Abundance matrix: rows = features, columns = samples
species <- c("s1", "s2", "s3", "s4")
samples <- c("Sample1", "Sample2", "Sample3")
abund <- matrix(
  c(
    10, 5,  0, # s1
    0,  8, 12, # s2
    4,  3,  7, # s3
    6,  0,  9 # s4
  ),
  nrow = length(species),
  ncol = length(samples),
  byrow = TRUE,
  dimnames = list(species, samples)
)

# Dissimilarity matrix among features (0-1), names must match abund rownames
diss <- matrix(
  c(
    0.0, 0.2, 0.7, 1.0,
    0.2, 0.0, 0.6, 0.9,
    0.7, 0.6, 0.0, 0.4,
    1.0, 0.9, 0.4, 0.0
  ),
  nrow = length(species),
  ncol = length(species),
  byrow = TRUE,
  dimnames = list(species, species)
)

# Clusters per feature (used by multiplicity_* indices)
clusters <- c(s1 = "A", s2 = "A", s3 = "B", s4 = "B")

## Run divermeta
divermeta(abund,
  clusters = clusters,
  diss = diss,
  q = 1,
  sig = 0.8,
  indices = c("multiplicity_inventory", "multiplicity_distance", "raoQ", "redundancy")
)

}
\seealso{
\code{\link[=multiplicity.inventory]{multiplicity.inventory()}}, \code{\link[=multiplicity.distance]{multiplicity.distance()}}, \code{\link[=diversity.functional]{diversity.functional()}},
\code{\link[=diversity.functional.traditional]{diversity.functional.traditional()}}, \code{\link[=raoQuadratic]{raoQuadratic()}}, \code{\link[=redundancy]{redundancy()}}
}
