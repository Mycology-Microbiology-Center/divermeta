% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/support_functions.R
\name{dist_quadratic_form}
\alias{dist_quadratic_form}
\title{Quadratic Form for a Distance Object}
\usage{
dist_quadratic_form(p, diss)
}
\arguments{
\item{p}{Numeric vector of length \( n \), representing the weights or abundances.}

\item{diss}{A \code{dist} object of size \( n \) (as returned by \code{vegdist} or \code{dist}),
containing the pairwise distances between observations.}
}
\value{
A numeric scalar, the value of the quadratic form \( P^\top M P \).
}
\description{
Computes the quadratic form \( \sum_{i,j} 2 \, p_i \, p_j \, m_{ij} \)
for a vector \code{p} and a \code{dist} object \code{m}. This is equivalent to
\( P^\top M P \) where \code{M} is the full distance matrix, without
explicitly constructing the full matrix.
}
\details{
The function uses the fact that a \code{dist} object stores only the lower triangle of
the distance matrix in column-major order. It constructs all pairs of indices
corresponding to this storage order and computes the sum efficiently.
}
\examples{
library(vegan)
data(dune)
diss <- vegdist(dune)
p <- runif(nrow(dune))
dist_quadratic_form(p, diss)

}
